//  CREATE DATABASE library_db;
//  USE library_db;
//  CREATE TABLE books (book_id INT PRIMARY KEY, title VARCHAR(200), author VARCHAR(100), total_copies INT, available_copies INT);
//  INSERT INTO books VALUES (1, 'DBMS', 'Korth', 5, 5), (2, 'Operating System', 'Galvin', 3, 3), (3, 'Java Programming', 'Herbert', 4, 4);
//  CREATE TABLE students (student_id INT PRIMARY KEY, name VARCHAR(100), department VARCHAR(50));
//  INSERT INTO students VALUES (101, 'Amit', 'CSE'), (102, 'Rahul', 'IT'), (103, 'Neha', 'ECE');
//  CREATE TABLE borrow_records (borrow_id INT AUTO_INCREMENT PRIMARY KEY, student_id INT, book_id INT, borrow_date DATE, due_date DATE, return_date DATE NULL, fine_amount DECIMAL(10,2) DEFAULT 0, FOREIGN KEY (student_id) REFERENCES students(student_id), FOREIGN KEY (book_id) REFERENCES books(book_id));


//   Book inventory - ISSUE A BOOK
START TRANSACTION;

UPDATE books SET available_copies = available_copies - 1 WHERE book_id = 1 AND available_copies > 0;
+---------+------------------+---------+--------------+------------------+
| book_id | title            | author  | total_copies | available_copies |
+---------+------------------+---------+--------------+------------------+
|       1 | DBMS             | Korth   |            5 |                4 |
|       2 | Operating System | Galvin  |            3 |                3 |
|       3 | Java Programming | Herbert |            4 |                4 |
+---------+------------------+---------+--------------+------------------+

INSERT INTO borrow_records (student_id, book_id, borrow_date, due_date) VALUES (101, 1, CURDATE(), DATE_ADD(CURDATE(), INTERVAL 7 DAY));
+-----------+------------+---------+-------------+------------+-------------+-------------+
| borrow_id | student_id | book_id | borrow_date | due_date   | return_date | fine_amount |
+-----------+------------+---------+-------------+------------+-------------+-------------+
|         1 |        101 |       1 | 2026-02-08  | 2026-02-15 | NULL        |        0.00 |
+-----------+------------+---------+-------------+------------+-------------+-------------+

COMMIT;


//  RETURN BOOK + FINE CALCULATION
SELECT b.borrow_id, s.name AS student_name, bk.title AS book_title, b.borrow_date, b.due_date, b.return_date, b.fine_amount FROM borrow_records b JOIN students s ON b.student_id = s.student_id JOIN books bk ON b.book_id = bk.book_id;
+-----------+--------------+------------+-------------+------------+-------------+-------------+
| borrow_id | student_name | book_title | borrow_date | due_date   | return_date | fine_amount |
+-----------+--------------+------------+-------------+------------+-------------+-------------+
|         1 | Amit         | DBMS       | 2026-02-08  | 2026-02-15 | NULL        |        0.00 |
+-----------+--------------+------------+-------------+------------+-------------+-------------+
+---------+------------------+---------+--------------+------------------+
| book_id | title            | author  | total_copies | available_copies |
+---------+------------------+---------+--------------+------------------+
|       1 | DBMS             | Korth   |            5 |                4 |
|       2 | Operating System | Galvin  |            3 |                3 |
|       3 | Java Programming | Herbert |            4 |                4 |
+---------+------------------+---------+--------------+------------------+
